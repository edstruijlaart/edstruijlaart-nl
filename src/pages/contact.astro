---
import BaseLayout from '../layouts/BaseLayout.astro';
import Button from '../components/ui/Button.astro';
---

<BaseLayout
  title="Contact"
  description="Neem contact op met Ed Struijlaart voor boekingen, huiskamerconcerten of andere vragen."
>
  <section class="py-24">
    <div class="mx-auto max-w-[1200px] px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Contact info -->
        <div>
          <h1 class="font-[var(--font-display)] text-4xl lg:text-5xl">Contact</h1>
          <div class="mt-4 h-1 w-16 rounded-full" style="background-color: var(--color-gold);"></div>

          <div class="mt-8 space-y-6">
            <div>
              <h2 class="font-[var(--font-display)] text-2xl">Boekingen & management</h2>
              <p class="mt-2 text-lg text-[var(--fg-muted)]">
                Voor boekingen van huiskamerconcerten, theater of festivals:
              </p>
              <a
                href="mailto:ed@earswantmusic.nl"
                class="mt-2 inline-block text-lg text-[var(--color-gold)] hover:text-[var(--color-gold-light)] transition-colors duration-300"
              >
                ed@earswantmusic.nl
              </a>
            </div>

            <div>
              <h2 class="font-[var(--font-display)] text-2xl">Huiskamerconcert boeken</h2>
              <p class="mt-2 text-lg text-[var(--fg-muted)]">
                Wil je Ed boeken voor een intieme avond bij jou thuis? Een huiskamerconcert is geschikt
                voor 10 tot 50 personen.
              </p>
              <a
                href="https://boeken.edstruijlaart.nl"
                class="mt-2 inline-block text-lg text-[var(--color-gold)] hover:text-[var(--color-gold-light)] transition-colors duration-300"
              >
                Boek direct via boeken.edstruijlaart.nl â†’
              </a>
            </div>

            <div>
              <h2 class="font-[var(--font-display)] text-2xl">Theater programmeren</h2>
              <p class="mt-2 text-lg text-[var(--fg-muted)]">
                Wil je Gitaarmannen of een andere productie programmeren in jouw theater?
                Neem contact op met Mark van ATnext:
              </p>
              <a
                href="mailto:mark@atnext.nl"
                class="mt-2 inline-block text-lg text-[var(--color-gold)] hover:text-[var(--color-gold-light)] transition-colors duration-300"
              >
                mark@atnext.nl
              </a>
            </div>
          </div>
        </div>

        <!-- Contact form -->
        <div
          class="p-6 lg:p-8 rounded-lg"
          style="background-color: var(--bg-surface); box-shadow: var(--shadow-card);"
        >
          <h2 class="font-[var(--font-display)] text-2xl mb-6">Stuur een bericht</h2>
          <form id="contact-form" class="space-y-4" action="https://formspree.io/f/mzdabblp" method="POST">
            <div>
              <label for="name" class="block text-sm font-medium mb-1">Naam</label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="w-full px-4 py-3 rounded-lg border border-[var(--bg-surface)] text-base transition-colors duration-300 focus:border-[var(--color-gold)] focus:outline-none"
                style="background-color: var(--bg); color: var(--fg);"
              />
            </div>
            <div>
              <label for="email" class="block text-sm font-medium mb-1">E-mail</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-4 py-3 rounded-lg border border-[var(--bg-surface)] text-base transition-colors duration-300 focus:border-[var(--color-gold)] focus:outline-none"
                style="background-color: var(--bg); color: var(--fg);"
              />
            </div>
            <div>
              <label for="subject" class="block text-sm font-medium mb-1">Onderwerp</label>
              <select
                id="subject"
                name="subject"
                class="w-full px-4 py-3 rounded-lg border border-[var(--bg-surface)] text-base transition-colors duration-300 focus:border-[var(--color-gold)] focus:outline-none"
                style="background-color: var(--bg); color: var(--fg);"
              >
                <option>Huiskamerconcert boeken</option>
                <option>Theater programmeren</option>
                <option>Media / pers</option>
                <option>Samenwerking</option>
                <option>Anders</option>
              </select>
            </div>
            <div>
              <label for="message" class="block text-sm font-medium mb-1">Bericht</label>
              <textarea
                id="message"
                name="message"
                rows="5"
                required
                class="w-full px-4 py-3 rounded-lg border border-[var(--bg-surface)] text-base transition-colors duration-300 focus:border-[var(--color-gold)] focus:outline-none resize-y"
                style="background-color: var(--bg); color: var(--fg);"
              ></textarea>
            </div>
            <button
              type="submit"
              class="px-8 py-3 rounded-full font-medium text-base text-white transition-colors duration-300 bg-[var(--color-gold)] hover:bg-[var(--color-gold-light)] disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Verstuur bericht
            </button>
            <p id="contact-message" class="text-sm min-h-[1.25rem]" aria-live="polite"></p>
          </form>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  function initContactForm() {
    const form = document.getElementById('contact-form') as HTMLFormElement;
    if (!form || form.dataset.init) return;
    form.dataset.init = '1';

    const messageEl = document.getElementById('contact-message')!;
    const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Bezig met versturen...';
      submitBtn.disabled = true;
      messageEl.textContent = '';
      messageEl.className = 'text-sm min-h-[1.25rem]';

      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: new FormData(form),
          headers: { 'Accept': 'application/json' },
        });

        if (response.ok) {
          messageEl.textContent = 'Bedankt! Je bericht is verzonden. Ik neem zo snel mogelijk contact op.';
          messageEl.classList.add('text-[var(--color-gold)]');
          form.reset();
        } else {
          messageEl.textContent = 'Er ging iets mis bij het versturen. Probeer het opnieuw of mail direct.';
          messageEl.classList.add('text-red-500');
        }
      } catch {
        messageEl.textContent = 'Geen verbinding. Probeer het later opnieuw of mail naar ed@earswantmusic.nl.';
        messageEl.classList.add('text-red-500');
      } finally {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    });
  }

  initContactForm();
  document.addEventListener('astro:after-swap', initContactForm);
</script>
